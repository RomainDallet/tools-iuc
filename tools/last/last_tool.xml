<tool id="last_tool" name="LAST" version="@LAST_CONDA_VERSION@+galaxy0" python_template_version="3.5">
    <description>finds similar regions between sequences.</description>
    <macros>
        <token name="@LAST_CONDA_VERSION@">1021</token>
    </macros>
    <requirements>
        <requirement type="package" version="@LAST_CONDA_VERSION@">last</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
        lastdb
        $args_db
        ref_files
        '$ref_fasta'
        &&
        lastal
        $args_al
        ref_files
        '$int_fasta'
        $last_split
        > '$result'
    ]]></command>
    <inputs>
        <param name="ref_fasta" type="data" format="fasta" label="Reference sequence fasta file" />
        <param name="int_fasta" type="data" format="fasta" label="Sequence of interest fasta file" />
        <param name="protein" type="boolean" truevalue="-p" falsevalue="" checked="false" label="The sequences are proteins"/>
        <param name="args_db" type="select" multiple="false" label="Lastdb arguments">
            <option value="-cR01" selected="true">Suppresses alignments caused by simple sequence (-cR01)</option>
            <option value="-uNEAR -R01">Find short-and-strong similarities (-uNEAR -R01)</option>
        </param>
        <param name="args_al" type="select" multiple="false" label="Lastal arguments">
            <option value="" selected="true">None</option>
            <option value="-F15">Specify translated alignment with a score penalty of 15 for frameshifts (-F15)</option>
            <option value="-pPAM30">Scoring scheme finds strong protein similarities (-pPAM30)</option>
            <option value="-D100">Makes lastal report alignments that could occur by chance once per hundred query letters (-D100)</option>
            <option value="-Q1">Indicates fastq-sanger format (-Q1)</option>
            <option value="-j4">Estimate the ambiguity of each column in an alignment (-j4)</option>
        </param>
        <param name="last_split" type="boolean" truevalue="| last-split" falsevalue="" checked="false" label="Looks for a unique best alignment for each part of each query." help="It allows different parts of one query to match different parts of the genome, which may happen due to rearrangements."/>
    </inputs>
    <outputs>
        <data name="result" format="maf" />
    </outputs>
    <tests>
        <test>
            <param name="ref_fasta" value="humanMito.fa" />
            <param name="int_fasta" value="fuguMito.fa" />
            <param name="args_db" value="-cR01" />
            <output name="result" file="humanMito-fuguMito.maf" />
        </test>
    </tests>
    <help><![CDATA[
        LAST finds similar regions between sequences.

        The main technical innovation is that LAST finds initial matches based on their multiplicity, instead of using a fixed length (e.g. BLAST uses 11-mers). To find these variable-length matches, it uses a suffix array (inspired by Vmatch). To achieve high sensitivity, it uses a spaced suffix array (or subset suffix array), analogous to spaced seeds (or subset seeds).

        LAST can:
            - Handle big sequence data, e.g:
                - Compare two vertebrate genomes.
                - Align billions of DNA reads to a genome.
            - Indicate the reliability of each aligned column.
            - Use sequence quality data properly.
            - Compare DNA to proteins, with frameshifts.
            - Compare PSSMs to sequences.
            - Calculate the likelihood of chance similarities between random sequences.
            - Do split and spliced alignment.
            - Train alignment parameters for unusual kinds of sequence (e.g. nanopore).

    ]]></help>
    <citations></citations>
</tool>